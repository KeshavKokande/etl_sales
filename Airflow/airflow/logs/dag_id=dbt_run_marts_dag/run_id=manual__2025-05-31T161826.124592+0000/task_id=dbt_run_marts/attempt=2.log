{"timestamp":"2025-05-31T16:20:45.775265","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-05-31T16:20:45.776496","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/dbt_orchestration_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-05-31T16:20:45.824975","level":"info","event":"Tmp dir root location: /tmp","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:20:45.829621","level":"info","event":"Running command: ['/usr/bin/bash', '-c', 'cd /opt/airflow/dbt_project/mockkaro_dbt && dbt run --select marts']","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:20:45.854853","level":"info","event":"Output:","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:20:50.672224","level":"info","event":"\u001b[0m16:20:50  Running with dbt=1.9.6","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:20:52.920616","level":"info","event":"\u001b[0m16:20:52  Registered adapter: snowflake=1.9.4","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:20:53.385911","level":"info","event":"\u001b[0m16:20:53  Unable to do partial parsing because of a version mismatch","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:20:59.392108","level":"info","event":"\u001b[0m16:20:59  [\u001b[33mWARNING\u001b[0m]: Test 'test.mockkaro_dbt.relationships_fact_orders_CUSTOMER_ID_NK__customer_id__ref_dim_customer_.856110df7f' (models/marts/fact/fact_orders.yml) depends on a node named 'dim_customer' in package '' which was not found","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:20:59.531016","level":"info","event":"\u001b[0m16:20:59  [\u001b[33mWARNING\u001b[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:20:59.531206","level":"info","event":"There are 2 unused configuration paths:","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:20:59.531290","level":"info","event":"- models.mockkaro_dbt.marts.dim","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:20:59.531435","level":"info","event":"- models.mockkaro_dbt.marts.fact","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:20:59.761358","level":"info","event":"\u001b[0m16:20:59  Found 12 models, 40 data tests, 1 source, 476 macros","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:20:59.768114","level":"info","event":"\u001b[0m16:20:59","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:20:59.770748","level":"info","event":"\u001b[0m16:20:59  Concurrency: 4 threads (target='dev')","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:20:59.773237","level":"info","event":"\u001b[0m16:20:59","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:21:02.473250","level":"info","event":"\u001b[0m16:21:02  1 of 8 START sql table model STG_final.dim_customers ........................... [RUN]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:21:02.475332","level":"info","event":"\u001b[0m16:21:02  2 of 8 START sql table model STG_final.dim_employee ............................ [RUN]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:21:02.476557","level":"info","event":"\u001b[0m16:21:02  3 of 8 START sql table model STG_final.dim_issue_type .......................... [RUN]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:21:02.477576","level":"info","event":"\u001b[0m16:21:02  4 of 8 START sql table model STG_final.dim_product ............................. [RUN]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:21:03.986944","level":"info","event":"\u001b[0m16:21:03  3 of 8 OK created sql table model STG_final.dim_issue_type ..................... [\u001b[32mSUCCESS 1\u001b[0m in 1.44s]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:21:03.989554","level":"info","event":"\u001b[0m16:21:03  1 of 8 OK created sql table model STG_final.dim_customers ...................... [\u001b[32mSUCCESS 1\u001b[0m in 1.46s]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:21:03.990834","level":"info","event":"\u001b[0m16:21:03  2 of 8 OK created sql table model STG_final.dim_employee ....................... [\u001b[32mSUCCESS 1\u001b[0m in 1.48s]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:21:03.992187","level":"info","event":"\u001b[0m16:21:03  4 of 8 OK created sql table model STG_final.dim_product ........................ [\u001b[32mSUCCESS 1\u001b[0m in 1.49s]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:21:04.010529","level":"info","event":"\u001b[0m16:21:04  5 of 8 START sql view model STG_FINAL.dim_store ................................ [RUN]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:21:04.014217","level":"info","event":"\u001b[0m16:21:04  6 of 8 START sql table model STG_final.fact_orders ............................. [RUN]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:21:04.019511","level":"info","event":"\u001b[0m16:21:04  7 of 8 START sql table model STG_final.fact_tickets ............................ [RUN]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:21:04.564868","level":"info","event":"\u001b[0m16:21:04  5 of 8 ERROR creating sql view model STG_FINAL.dim_store ....................... [\u001b[31mERROR\u001b[0m in 0.54s]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:21:04.896464","level":"info","event":"\u001b[0m16:21:04  6 of 8 OK created sql table model STG_final.fact_orders ........................ [\u001b[32mSUCCESS 1\u001b[0m in 0.87s]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:21:04.917855","level":"info","event":"\u001b[0m16:21:04  8 of 8 START sql table model STG_final.fact_sales_summary ...................... [RUN]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:21:04.920875","level":"info","event":"\u001b[0m16:21:04  7 of 8 OK created sql table model STG_final.fact_tickets ....................... [\u001b[32mSUCCESS 1\u001b[0m in 0.89s]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:21:05.680816","level":"info","event":"\u001b[0m16:21:05  8 of 8 OK created sql table model STG_final.fact_sales_summary ................. [\u001b[32mSUCCESS 1\u001b[0m in 0.76s]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:21:06.628687","level":"info","event":"\u001b[0m16:21:06","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:21:06.629339","level":"info","event":"\u001b[0m16:21:06  Finished running 7 table models, 1 view model in 0 hours 0 minutes and 6.85 seconds (6.85s).","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:21:06.705750","level":"info","event":"\u001b[0m16:21:06","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:21:06.706411","level":"info","event":"\u001b[0m16:21:06  \u001b[31mCompleted with 1 error, 0 partial successes, and 0 warnings:\u001b[0m","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:21:06.707053","level":"info","event":"\u001b[0m16:21:06","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:21:06.707874","level":"info","event":"\u001b[0m16:21:06    Database Error in model dim_store (models/marts/dim/dim_store.sql)","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:21:06.708079","level":"info","event":"  000904 (42000): SQL compilation error: error line 18 at position 4","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:21:06.708185","level":"info","event":"  invalid identifier 'STORE_ID'","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:21:06.708264","level":"info","event":"  compiled code at target/run/mockkaro_dbt/models/marts/dim/dim_store.sql","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:21:06.708726","level":"info","event":"\u001b[0m16:21:06","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:21:06.709519","level":"info","event":"\u001b[0m16:21:06  Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:21:09.011537","level":"info","event":"Command exited with return code 1","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook"}
{"timestamp":"2025-05-31T16:21:09.017706","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"AirflowException","exc_value":"Bash command failed. The command returned a non-zero exit code 1.","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":838,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1130,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":408,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/bash.py","lineno":233,"name":"execute"}]}]}
{"timestamp":"2025-05-31T16:21:09.061637","level":"error","event":"Top level error","logger":"task","error_detail":[{"exc_type":"UndefinedError","exc_value":"'airflow.sdk.execution_time.task_runner.RuntimeTaskInstance object' has no attribute 'log_url'","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1268,"name":"main"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1248,"name":"finalize"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1076,"name":"_send_task_error_email"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py","lineno":473,"name":"_get_email_subject_content"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py","lineno":470,"name":"render"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/helpers.py","lineno":244,"name":"render_template_to_string"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/helpers.py","lineno":239,"name":"render_template"},{"filename":"<template>","lineno":22,"name":"root"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/jinja2/runtime.py","lineno":859,"name":"_fail_with_undefined_error"}]}]}
{"timestamp":"2025-05-31T16:21:09.073601Z","level":"warning","event":"Process exited abnormally","exit_code":1,"logger":"task"}
